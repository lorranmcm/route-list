<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>jQuery UI Sortable - Default functionality</title>
  <link rel="stylesheet" href="//code.jquery.com/ui/1.13.0/themes/base/jquery-ui.css">
  <link rel="stylesheet" href="/resources/demos/style.css">
  <style>
  #sortable { list-style-type: none; margin: 0; padding: 0; width: 60%; }
  #sortable li { margin: 0 3px 3px 3px; padding: 0.4em; padding-left: 1.5em; font-size: 1.4em; height: 18px; }
  #sortable li span { position: absolute; margin-left: -1.3em; }
  </style>
  <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
  <script src="https://code.jquery.com/ui/1.13.0/jquery-ui.js"></script>
  <script>
  $( function() {
    $( "#sortable" ).sortable();
  } );
  </script>
</head>

<!-- Container -->
<div class="container" data-controller="index create-task chat"  data-project-id=<%=@project.id%>>
  <div class="row">
    <!-- Column 1: Task list card -->
    <div class="col-sm-4 p-0">
      <% @project.tasks.each do |task| %>
        <div class="card-product" data-action="click->index#opendescription click->chat#openchat" data-task-id=<%=task.id%> data-chat-id=<%=task.chatroom.id%>>
          <div class="card-product-infos">
            <span class="handle"><i class="fas fa-grip-vertical grip text-secondary" id="toggle"></i></span>
            <h2><%=task.title%></h2>
            <%= simple_form_for([@project, task]) do |f| %>
              <%= f.input :status, :as => :hidden, :input_html => { :value => 0 } %>
              <%= button_tag(type: 'submit', class: "fas fa-check") do %>
                <i></i>
              <% end %>
            <% end %>
          </div>
        </div>
      <%end%>
      <!-- Create new Task buttons (2) -->
      <a class="btn btn-flat" data-action="click->index#newtaskform">Create New Task</a>
    </div>
    <!-- Column 2: Task description -->
    <div class="col-sm-4">
      <div data-index-target="taskdescription">
      </div>
    </div>
    <!-- Column 3: Geocoder -->
    <div class="col-sm-4">
      <div class="mapbox">
        <div id="map"
          style="width: 100%; height: 300px;"
          data-markers="<%= @markers.to_json %>"
          data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">
        </div>
      </div>
     <!-- Column 3: Chatroom -->
      <div id="chat" data-chat-target="chatbox">
      </div>
    </div>
  </div>
</div>
